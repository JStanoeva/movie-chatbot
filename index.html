<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-P">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🧀 Cheesy Movie Bot 🎬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FFFBEB; /* Creamy yellow, like a mild cheese */
        }
        .chat-bubble {
            padding: 12px 18px;
            border-radius: 20px;
            margin-bottom: 10px;
            max-width: 80%;
            word-wrap: break-word;
        }
        .user-bubble {
            background-color: #FDE68A; /* A nice cheddar yellow */
            color: #78350F; /* Brown for text, good contrast */
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }
        .bot-bubble {
            background-color: #FEF3C7; /* Lighter cheese color */
            color: #9A3412; /* Darker orange/brown for bot text */
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }
        .bot-bubble.error {
            background-color: #FECACA; /* Light red for errors */
            color: #991B1B; /* Dark red for error text */
        }
        .movie-card {
            background-color: #FFFFFF;
            border: 2px solid #FDBA74; /* Orange border, like aged cheese rind */
            border-radius: 15px;
            padding: 20px;
            margin-top: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .movie-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #D97706; /* Amber color for titles */
            margin-bottom: 8px;
        }
        .movie-details p {
            margin-bottom: 6px;
            color: #4B5563; /* Gray for details */
        }
        .movie-details strong {
            color: #78350F; /* Brown for labels */
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #FFFBEB;
        }
        ::-webkit-scrollbar-thumb {
            background: #FDBA74;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #FB923C;
        }
        /* Custom focus rings for accessibility and style */
        input[type="text"]:focus, button:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(251, 146, 60, 0.5); /* Orange glow */
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4 selection:bg-amber-300 selection:text-amber-900">

    <div class="w-full max-w-2xl bg-white/80 backdrop-blur-md shadow-2xl rounded-xl p-6 md:p-8">
        <header class="text-center mb-6">
            <h1 class="text-4xl font-bold text-amber-600">🧀 Cheesy Movie Bot 🎬</h1>
            <p class="text-amber-800 mt-2">Your royal guide to all things cinema... with a sprinkle of cheese!</p>
        </header>

        <div id="chat-window" class="h-96 overflow-y-auto mb-4 p-4 bg-amber-50 rounded-lg flex flex-col space-y-3">
            </div>

        <div class="flex space-x-3">
            <input type="text" id="movie-input" class="flex-grow p-3 border-2 border-amber-300 rounded-lg focus:border-amber-500 transition-colors" placeholder="Type a movie title or '🧀'...">
            <button id="send-button" class="bg-amber-500 hover:bg-amber-600 text-white font-semibold py-3 px-6 rounded-lg transition-colors shadow-md hover:shadow-lg">
                Send
            </button>
        </div>
    </div>

    <footer class="mt-8 text-center text-sm text-amber-700">
        <p>A *grate* creation for Queen Tora! Powered by OMDb API.</p>
    </footer>

    <script>
        const chatWindow = document.getElementById('chat-window');
        const movieInput = document.getElementById('movie-input');
        const sendButton = document.getElementById('send-button');

        // IMPORTANT: Replace with your actual OMDb API key if needed.
        // For this demonstration, Queen Tora's key is used.
        // In a real production app, API keys should NOT be exposed in client-side code.
        // They should be handled by a backend server.
        const apiKey = '24feda60'; 

        let isCheeseModeActive = localStorage.getItem('cheeseMode') === 'true'; // Load cheese mode state

        // Initial greeting from the bot
        function initialGreeting() {
            addBotMessage("Greetings, Your Royal Cheesiness! 👑 I'm your personal movie maître d'. What cinematic delight are we slicing into today? Or perhaps you'd like to activate a *special* cheesy feature? 😉");
        }

        function addMessageToChat(message, sender) {
            const bubble = document.createElement('div');
            bubble.classList.add('chat-bubble');
            if (sender === 'user') {
                bubble.classList.add('user-bubble');
                bubble.textContent = message;
            } else if (sender === 'bot-error') {
                bubble.classList.add('bot-bubble', 'error');
                bubble.innerHTML = message; // Use innerHTML for bot messages that might contain HTML
            }
            else { // bot
                bubble.classList.add('bot-bubble');
                bubble.innerHTML = message; // Use innerHTML for bot messages that might contain HTML
            }
            chatWindow.appendChild(bubble);
            chatWindow.scrollTop = chatWindow.scrollHeight; // Auto-scroll to the latest message
        }

        function addUserMessage(message) {
            addMessageToChat(message, 'user');
        }

        function addBotMessage(message) {
            // Add a little "typing" delay for realism
            setTimeout(() => {
                addMessageToChat(message, 'bot');
            }, 500);
        }
        
        function addBotErrorMessage(message) {
             setTimeout(() => {
                addMessageToChat(message, 'bot-error');
            }, 500);
        }


        async function fetchMovieData(movieTitle) {
            addBotMessage("On it, Your Majesty! 🕵️‍♂️ Searching the great cheese wheel of cinema for '" + movieTitle + "'...");
            try {
                const response = await fetch(`https://www.omdbapi.com/?apikey=${apiKey}&t=${encodeURIComponent(movieTitle)}`);
                const data = await response.json();

                if (data.Response === "True") {
                    displayMovieInfo(data);
                } else {
                    addBotErrorMessage(`Oh crumbs! 😥 It seems "${movieTitle}" has crumbled from my grasp. "${data.Error || 'Movie not found!'}" Perhaps another selection from the cheese board of films?`);
                }
            } catch (error) {
                console.error("Error fetching movie data:", error);
                addBotErrorMessage("Uh oh! My wires got a bit tangled trying to fetch that. It's not very *gouda*. Please try again!");
            }
        }

        function displayMovieInfo(movie) {
            const titlePrefix = isCheeseModeActive ? "🧀 " : "";
            let ratingsHTML = movie.Ratings && movie.Ratings.length > 0 ? 
                movie.Ratings.map(rating => `<p><strong>${rating.Source}:</strong> ${rating.Value}</p>`).join('') :
                (movie.imdbRating && movie.imdbRating !== "N/A" ? `<p><strong>IMDb Rating:</strong> ${movie.imdbRating}</p>` : '<p>No ratings available.</p>');

            if (movie.imdbRating && movie.imdbRating !== "N/A" && !movie.Ratings.find(r => r.Source === "Internet Movie Database")) {
                 ratingsHTML += `<p><strong>IMDb Rating:</strong> ${movie.imdbRating}</p>`;
            }


            const movieCardHTML = `
                <div class="movie-card">
                    <h2 class="movie-title">${titlePrefix}${movie.Title}</h2>
                    <div class="movie-details">
                        <p><strong>Released:</strong> ${movie.Year || 'N/A'}</p>
                        <p><strong>Genre:</strong> ${movie.Genre || 'N/A'}</p>
                        <p><strong>Plot:</strong> ${movie.Plot || 'N/A'}</p>
                        <h3 class="font-semibold mt-3 mb-1 text-amber-700">Ratings:</h3>
                        ${ratingsHTML}
                        <p class="mt-2"><strong>Director:</strong> ${movie.Director || 'N/A'}</p>
                        <p><strong>Actors:</strong> ${movie.Actors || 'N/A'}</p>
                        ${movie.Poster && movie.Poster !== "N/A" ? `<img src="${movie.Poster}" alt="Poster for ${movie.Title}" class="mt-4 rounded-lg shadow-md max-w-xs mx-auto" onerror="this.style.display='none'">` : ''}
                    </div>
                </div>
            `;
            addBotMessage("Aha! A *gouda* find! Here's the scoop on " + movie.Title + ":" + movieCardHTML);
        }

        function handleUserInput() {
            const userInput = movieInput.value.trim();
            if (!userInput) return;

            addUserMessage(userInput);
            movieInput.value = ''; // Clear input field

            if (userInput === "🧀") {
                isCheeseModeActive = !isCheeseModeActive;
                localStorage.setItem('cheeseMode', isCheeseModeActive); // Save cheese mode state
                if (isCheeseModeActive) {
                    addBotMessage("Huzzah! 🥳 You've activated **SUPER CHEESE MODE**! All movie titles will now be extra cheesy! It's gonna be *brie-lliant*!");
                } else {
                    addBotMessage("Super Cheese Mode deactivated. We're back to regular, still very delightful, movie searching. Still *fondue-tastic*!");
                }
            } else {
                fetchMovieData(userInput);
            }
        }

        sendButton.addEventListener('click', handleUserInput);
        movieInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                handleUserInput();
            }
        });

        // Display initial greeting when the page loads
        initialGreeting();
    </script>

</body>
</html>
